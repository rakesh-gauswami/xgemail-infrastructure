{
  "AWSTemplateFormatVersion": "2010-09-09",

  "Description": "Xgemail SNS Subscription Template",

  "Metadata": {
    "Copyright": [
      "Copyright 2019, Sophos Limited. All rights reserved.",
      "",
      "'Sophos' and 'Sophos Anti-Virus' are registered trademarks of",
      "Sophos Limited and Sophos Group.  All other product and company",
      "names mentioned are trademarks or registered trademarks of their",
      "respective owners."
    ],

    "Comments": [
      "Marries SNS topics to SQS queues to support XGEMAIL messaging."
    ]
  },

  "Parameters": {
    "AdditionalActionTopicArn": {
      "Description": "Endpoint for scan Additional Action arn",
      "Type": "String"
    },
    "BounceEventTopicArn": {
      "Description": "Endpoint for scan Bounce events arn",
      "Type": "String"
    },
    "DelayTopicArn": {
      "Description": "TopicArn of Delay Events SNS",
      "Type": "String"
    },
    "DeletedEventsTopicArn": {
      "Description": "TopicArn of Deleted Events SNS",
      "Type": "String"
    },
    "EncryptEventsTopicArn": {
      "Description": "TopicArn of Encrypt Events SNS",
      "Type": "String"
    },
    "EncryptionDeliveryEventsTopicArn": {
      "Description": "TopicArn for encryption delivery events SNS",
      "Type": "String"
    },
    "InternetDeliveryTopicArn": {
      "Description": "TopicArn of Internet delivery Events SNS",
      "Type": "String"
    },
    "MailOpsNotificationTopicArn": {
      "Description": "TopicArn of MailOps notification SNS",
      "Type": "String"
    },
    "MessageHistoryEventsTopicArn": {
      "Description": "Endpoint for message history Events SNS",
      "Type": "String"
    },
    "MessageHistoryStatusQueueTopicArn": {
      "Description": "Endpoint for message history Delivery Status SNS",
      "Type": "String"
    },
    "MessageHistoryStatusRetryQueueTopicArn": {
      "Description": "Endpoint for message history Delivery Status Retry SNS",
      "Type": "String"
    },
    "MessageStatisticsRejectionTopicArn": {
      "Description": "Endpoint for message statistics rejection SNS",
      "Type": "String"
    },
    "MultiPolicyTopicArn": {
      "Description": "Endpoint for multi policy arn",
      "Type": "String"
    },
    "NotifierQueueTopicArn": {
      "Description": "TopicArn of notifications SNS",
      "Type": "String"
    },
    "PolicyRefreshEventTopicArn": {
      "Description": "TopicArn of Policy Refresh Events SNS",
      "Type": "String"
    },
    "QuarantinedEventsTopicArn": {
      "Description": "TopicArn of Quarantined Events SNS",
      "Type": "String"
    },
    "RedirectEventTopicArn": {
      "Description": "Endpoint for scan Redirect events arn",
      "Type": "String"
    },
    "RiskyDeliveryTopicArn": {
      "Description": "TopicArn of Risky delivery Events SNS",
      "Type": "String"
    },
    "ScanEventsTopicArn": {
      "Description": "Endpoint for scan events arn",
      "Type": "String"
    },
    "SuccessEventsTopicArn": {
      "Description": "TopicArn of Success Events SNS",
      "Type": "String"
    },
    "AdditionalActionQueue": {
      "Description": "Endpoint ARN for Additional Action SQS Queue",
      "Type": "String"
    },
    "AllowBlockUploadQueue": {
      "Description": "Endpoint ARN for Allow Block Upload SQS Queue",
      "Type": "String"
    },
    "BounceEventQueue": {
      "Description": "Endpoint ARN for Bounce Event Action SQS Queue",
      "Type": "String"
    },
    "BulkSenderActionQueue": {
      "Description": "Endpoint ARN for Bulk Sender Action SQS Queue",
      "Type": "String"
    },
    "BulkSenderApprovalQueue": {
      "Description": "Endpoint ARN for Bulk Sender Approval SQS Queue",
      "Type": "String"
    },
    "BulkSenderEventNotificationQueue": {
      "Description": "Endpoint ARN for Bulk Sender Event Notification SQS Queue",
      "Type": "String"
    },
    "DelayQueue": {
      "Description": "Endpoint for delay SQS queue",
      "Type": "String"
    },
    "DeliveryQueue": {
      "Description": "Endpoint for delivery SQS queue",
      "Type": "String"
    },
    "EmergencyInboxQueue": {
      "Description": "Endpoint for emergency inbox SQS queue",
      "Type": "String"
    },
    "EncryptionDeliveryQueue": {
      "Description": "Endpoint for encryption delivery SQS queue",
      "Type": "String"
    },
    "ImpersonationRequestQueue": {
      "Description": "Endpoint for impersonation request SQS queue",
      "Type": "String"
    },
    "ImpersonationResponseQueue": {
      "Description": "Endpoint for impersonation response SQS queue",
      "Type": "String"
    },
    "InternetDeliveryQueue": {
      "Description": "Endpoint for Internet delivery SQS queue",
      "Type": "String"
    },
    "InternetSubmitServiceQueue": {
      "Description": "Endpoint for Internet submit service SQS queue",
      "Type": "String"
    },
    "MailOpsNotificationEmail": {
      "Description": "MailOps group email id",
      "Type": "String"
    },
    "MessageHistoryQueue": {
      "Description": "Endpoint for message history SQS queue",
      "Type": "String"
    },
    "MessageHistoryStatusQueue": {
      "Description": "Endpoint for message history Delivery Status SQS queue",
      "Type": "String"
    },
    "MessageHistoryStatusRetryQueue": {
      "Description": "Endpoint for message history Delivery Status Retry SQS queue",
      "Type": "String"
    },
    "MessageStatisticsQueue": {
      "Description": "Endpoint for message statistics SQS queue",
      "Type": "String"
    },
    "MessageStatisticsRejectionQueue": {
      "Description": "Endpoint for message statistics rejection SQS queue",
      "Type": "String"
    },
    "MultiPolicyQueue": {
      "Description": "Endpoint for multi Policy queue",
      "Type": "String"
    },
    "NotifierQueue": {
      "Description": "Endpoint for notifier SQS queue",
      "Type": "String"
    },
    "OutboundMalwareProtectionQueue": {
      "Description": "Endpoint for outbound malware protection SQS queue",
      "Type": "String"
    },
    "OutboundMalwareProtectionUnblockSenderQueue": {
      "Description": "Endpoint for outbound malware protection unblock sender SQS queue",
      "Type": "String"
    },
    "PolicyRefreshEventQueue": {
      "Description": "Endpoint for Policy Refresh Event SQS queue",
      "Type": "String"
    },
    "QuarantineQueue": {
      "Description": "Endpoint for quarantine SQS queue",
      "Type": "String"
    },
    "RedirectEventQueue": {
      "Description": "Endpoint ARN for Redirect Event Action SQS Queue",
      "Type": "String"
    },
    "RiskyDeliveryQueue": {
      "Description": "Endpoint for Risky delivery SQS queue",
      "Type": "String"
    }
  },

  "Resources": {
    "MailOpsNotifcationSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": { "Ref": "MailOpsNotificationEmail"},
        "Protocol": "Email-JSON",
        "TopicArn": { "Ref": "MailOpsNotificationTopicArn"}
      }
    },
    "MacroDetectionQueueToSuccessSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": "arn:aws:sqs:us-east-1:459806747212:dsml-email",
        "Protocol": "sqs",
        "TopicArn": { "Ref": "SuccessEventsTopicArn"}
      }
    },
    "MacroDetectionQueueToDeletedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": "arn:aws:sqs:us-east-1:459806747212:dsml-email",
        "Protocol": "sqs",
        "TopicArn": { "Ref": "DeletedEventsTopicArn"}
      }
    },
    "MacroDetectionQueueToQuarantinedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": "arn:aws:sqs:us-east-1:459806747212:dsml-email",
        "Protocol": "sqs",
        "TopicArn": { "Ref": "QuarantinedEventsTopicArn"}
      }
    },
    "MessageHistoryQueueToDeletedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "DeletedEventsTopicArn"}
      }
    },
    "MessageHistoryQueueToEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "MessageHistoryEventsTopicArn" }
      }
    },
    "MessageStatisticsQueueToDeletedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageStatisticsQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "DeletedEventsTopicArn"}
      }
    },
    "MessageHistoryQueueToQuarantinedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "QuarantinedEventsTopicArn"}
      }
    },
    "MessageHistoryQueueToEncryptEventsSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "EncryptEventsTopicArn"}
      }
    },
    "MessageStatisticsQueueToQuarantinedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageStatisticsQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "QuarantinedEventsTopicArn"}
      }
    },
    "QuarantineQueueToQuarantinedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "QuarantineQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "QuarantinedEventsTopicArn"}
      }
    },
    "DelayQueueToDelaySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "DelayQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "DelayTopicArn"}
      }
    },
    "DeliveryQueueToSuccessSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "DeliveryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "SuccessEventsTopicArn"}
      }
    },
    "EncryptionDeliveryQueueToEncryptionDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "EncryptionDeliveryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "EncryptionDeliveryEventsTopicArn"}
      }
    },
    "EncryptionDeliveryQueueToEncryptEventsSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "EncryptionDeliveryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "EncryptEventsTopicArn"}
      }
    },
    "EmergencyInboxQueueToSuccessSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "EmergencyInboxQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "SuccessEventsTopicArn"},
        "RawMessageDelivery": "true"
      }
    },
    "InternetDeliveryQueueToInternetDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "InternetDeliveryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "InternetDeliveryTopicArn"}
      }
    },
    "RiskyDeliveryQueueToRiskyDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "RiskyDeliveryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "RiskyDeliveryTopicArn"}
      }
    },
    "MessageHistoryDeliveryStatusQueueToMessageHistoryDeliveryStatusSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryStatusQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "MessageHistoryStatusQueueTopicArn"}
      }
    },
    "MessageHistoryDeliveryStatusRetryQueueToMessageHistoryDeliveryStatusRetrySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryStatusRetryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "MessageHistoryStatusRetryQueueTopicArn"}
      }
    },
    "MessageHistoryQueueToInternetDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "InternetDeliveryTopicArn"}
      }
    },
    "MessageHistoryQueueToRiskyDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "RiskyDeliveryTopicArn"}
      }
    },
    "MessageHistoryQueueToSuccessSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "SuccessEventsTopicArn"}
      }
    },
    "MessageStatisticsQueueToInternetDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageStatisticsQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "InternetDeliveryTopicArn"}
      }
    },
    "MessageStatisticsQueueToRiskyDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageStatisticsQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "RiskyDeliveryTopicArn"}
      }
    },
    "MessageStatisticsQueueToSuccessSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageStatisticsQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "SuccessEventsTopicArn"}
      }
    },
    "MessageStatisticsRejectionQueueToMessageStatisticsRejectionSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageStatisticsRejectionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "MessageStatisticsRejectionTopicArn"}
      }
    },
    "MultiPolicyQueueToMultiPolicySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MultiPolicyQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "MultiPolicyTopicArn"}
      }
    },
    "NotifierQueueToNotificationSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "NotifierQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "NotifierQueueTopicArn"},
        "RawMessageDelivery": "true"
      }
    },
    "OutboundMalwareProtectionQueueToNotificationSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "OutboundMalwareProtectionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "NotifierQueueTopicArn"},
        "RawMessageDelivery": "true"
      }
    },
    "MessageHistoryQueueToBounceEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "BounceEventTopicArn"}
      }
    },
    "MessageHistoryQueueToRedirectEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageHistoryQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "RedirectEventTopicArn"}
      }
    },
    "MessageStatisticsSNSListenerQueueToBounceEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageStatisticsQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "BounceEventTopicArn"}
      }
    },
    "AdditionalActionSNSListenerQueueToBounceEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "AdditionalActionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "BounceEventTopicArn"}
      }
    },
    "BounceEventSNSListenerQueueToBounceEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "BounceEventQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "BounceEventTopicArn"}
      }
    },
    "MessageStatisticsSNSListenerQueueToRedirectEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "MessageStatisticsQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "RedirectEventTopicArn"}
      }
    },
    "RedirectEventSNSListenerQueueToRedirectEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "RedirectEventQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "RedirectEventTopicArn"}
      }
    },
    "AdditionalActionSNSListenerQueueToRedirectEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "AdditionalActionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "RedirectEventTopicArn"}
      }
    },
    "AdditionalActionSNSListenerQueueToAdditionalActionSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "AdditionalActionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "AdditionalActionTopicArn"}
      }
    },
    "AdditionalActionQueueToSuccessSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "AdditionalActionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "SuccessEventsTopicArn"}
      }
    },
    "AdditionalActionQueueToDeletedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "AdditionalActionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "DeletedEventsTopicArn"}
      }
    },
    "AdditionalActionQueueToQuarantinedSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "AdditionalActionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "QuarantinedEventsTopicArn"}
      }
    },
    "AdditionalActionQueueToInternetDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "AdditionalActionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "InternetDeliveryTopicArn"}
      }
    },
    "AdditionalActionQueueToRiskyDeliverySnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "AdditionalActionQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "RiskyDeliveryTopicArn"}
      }
    },
    "PolicyRefreshEventQueueToPolicyRefreshEventSnsSubscription": {
      "Type" : "AWS::SNS::Subscription",
      "Properties": {
        "Endpoint": {"Fn::Join": [":", ["arn:aws:sqs", { "Ref" : "AWS::Region" }, { "Ref" : "AWS::AccountId" }, {"Ref": "PolicyRefreshEventQueue"}]]},
        "Protocol": "sqs",
        "TopicArn": { "Ref": "PolicyRefreshEventTopicArn"}
      }
    },
    "AllowBlockUploadQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "AllowBlockUploadQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*"
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "AllowBlockUploadQueue" }]]}]
      }
    },

    "BulkSenderActionQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "BulkSenderActionQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*"
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "BulkSenderActionQueue" }]]}]
      }
    },
    "BulkSenderApprovalQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "BulkSenderApprovalQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*"
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "BulkSenderApprovalQueue" }]]}]
      }
    },
    "BulkSenderEventNotificationQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "BulkSenderEventNotificationQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*"
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "BulkSenderEventNotificationQueue" }]]}]
      }
    },
    "DeliveryQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "DeliveryQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-SuccessEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "SuccessEventsTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "DeliveryQueue" }]]}]
      }
    },
    "DelayQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "DelayQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-DelayTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "DelayTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "DelayQueue" }]]}]
      }
    },
    "EmergencyInboxQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "EmergencyInboxQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-SuccessEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "SuccessEventsTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "EmergencyInboxQueue" }]]}]
      }
    },
    "InternetDeliveryQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "InternetDeliveryQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-InternetDeliveryTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "InternetDeliveryTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "InternetDeliveryQueue" }]]}]
      }
    },
    "RiskyDeliveryQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "RiskyDeliveryQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-RiskyDeliveryTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "RiskyDeliveryTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "RiskyDeliveryQueue" }]]}]
      }
    },
    "InternetSubmitServiceQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "InternetSubmitServiceQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-ScanEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "ScanEventsTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "InternetSubmitServiceQueue" }]]}]
      }
    },
    "MessageHistoryQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "MessageHistoryQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-DeletedEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "DeletedEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-InternetDeliveryTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "InternetDeliveryTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-QuarantinedEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "QuarantinedEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-SuccessEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "SuccessEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-RiskyDeliveryTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "RiskyDeliveryTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-RedirectEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "RedirectEventTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-BounceEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "BounceEventTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-EncryptEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "EncryptEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-MessageHistoryEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "MessageHistoryEventsTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "MessageHistoryQueue" }]]}]
      }
    },
    "MessageHistoryStatusQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "MessageHistoryStatusQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-MessageHistoryStatusQueueTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "MessageHistoryStatusQueueTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "MessageHistoryStatusQueue" }]]}]
      }
    },
    "MessageHistoryStatusRetryQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "MessageHistoryStatusRetryQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-MessageHistoryStatusRetryQueueTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "MessageHistoryStatusRetryQueueTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "MessageHistoryStatusRetryQueue" }]]}]
      }
    },
    "MessageStatisticsQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "MessageStatisticsQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-DeletedEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "DeletedEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-InternetDeliveryTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "InternetDeliveryTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-QuarantinedEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "QuarantinedEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-SuccessEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "SuccessEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-RedirectEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "RedirectEventTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-BounceEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "BounceEventTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-RiskyDeliveryTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "RiskyDeliveryTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "MessageStatisticsQueue" }]]}]
      }
    },
    "MessageStatisticsRejectionQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "MsgStatisticsRejectionQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-MsgStatisticsRejectionTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "MessageStatisticsRejectionTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "MessageStatisticsRejectionQueue" }]]}]
      }
    },
    "QuarantineQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "QuarantineQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-QuarantinedEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "QuarantinedEventsTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "QuarantineQueue" }]]}]
      }
    },
    "MultiPolicyQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "MultiPolicyQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-MultiPolicyTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "MultiPolicyTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "MultiPolicyQueue" }]]}]
      }
    },
    "AdditionalActionQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "AdditionalActionQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-AdditionalActionTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "AdditionalActionTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-RedirectEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "RedirectEventTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-BounceEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "BounceEventTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-SuccessEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "SuccessEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-DeletedEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "DeletedEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-QuarantinedEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "QuarantinedEventsTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-InternetDeliveryTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "InternetDeliveryTopicArn"}
                }
              }
            },
            {
              "Sid": "Allow-RiskyDeliveryTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "RiskyDeliveryTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "AdditionalActionQueue" }]]}]
      }
    },
    "RedirectEventQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "RedirectEventQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-RedirectEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "RedirectEventTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "RedirectEventQueue" }]]}]
      }
    },
    "BounceEventQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "BounceEventQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-BounceEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "BounceEventTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "BounceEventQueue" }]]}]
      }
    },
    "EncryptionDeliveryQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "EncryptionDeliveryQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-EncryptEventsTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "EncryptEventsTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "EncryptionDeliveryQueue" }]]}]
      }
    },
    "PolicyRefreshEventQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "PolicyRefreshEventQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-PolicyRefreshEventTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "PolicyRefreshEventTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [{"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "PolicyRefreshEventQueue" }]]}]
      }
    },
    "NotifierQueuePolicy": {
      "Type": "AWS::SQS::QueuePolicy",
      "Properties": {
        "PolicyDocument": {
          "Version": "2012-10-17",
          "Id": "NotifierQueuePolicy-id-{0a87be1d-a442-4db0-8863-555056ffeb06}",
          "Statement": [
            {
              "Sid": "Allow-NotifierTopicArn",
              "Effect": "Allow",
              "Principal": "*",
              "Action": ["sqs:SendMessage"],
              "Resource": "*",
              "Condition": {
                "ArnEquals": {
                  "aws:SourceArn": {"Ref": "NotifierQueueTopicArn"}
                }
              }
            }
          ]
        },
        "Queues": [
          {"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "NotifierQueue" }]]},
          {"Fn::Join": ["", ["https://sqs.", { "Ref" : "AWS::Region" }, ".amazonaws.com/", { "Ref" : "AWS::AccountId" }, "/", { "Ref": "OutboundMalwareProtectionQueue" }]]}
        ]
      }
    }
  }
}
